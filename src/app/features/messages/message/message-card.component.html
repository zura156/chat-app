@let message = this.message();
<div
  class="flex items-center mb-0"
  [ngClass]="{ 'justify-end': isCurrentUserMessage(message) }"
>
  <div class="flex flex-col">
    @if(isGroup() && !isCurrentUserMessage(message)){
    <span class="text-gray-500">
      {{ message.sender.username }}
    </span>
    }
    <div class="flex items-center justify-start">
      @if(!isCurrentUserMessage(message)){
      <hlm-avatar variant="small" class="min-w-fit mr-1.5">
        <img
          [src]="imageUrl() || '/icons/avatar.svg'"
          [alt]="message.sender.username"
          hlmAvatarImage
        />
        <span class="bg-[#FD005B] text-white" hlmAvatarFallback>RG</span>
      </hlm-avatar>
      }
      <div class="flex flex-col">
        <hlm-card hlmCard>
          <div class="py-1 px-3 text-ellipsis max-w-xs md:max-w-sm lg:max-w-md">
            <p>{{ message.content }}</p>
          </div>
        </hlm-card>
      </div>
    </div>
  </div>
</div>
@if(message.readReceipts && message.readReceipts.length > 0) {
  <div class="w-full flex items-center gap-x-1 justify-end pt-2">
    @for(readReceipt of message.readReceipts; track readReceipt.userId) {
      @let userCredentials = this.getUserCredentials(readReceipt.userId);
      <hlm-avatar variant="2xs" class="min-w-fit">
        <img
          [src]="userCredentials.profile_picture || '/icons/avatar.svg'"
          [alt]="userCredentials.username"
          hlmAvatarImage
        />
        <span class="bg-[#FD005B] text-white" hlmAvatarFallback>
          {{ userCredentials.username }}
        </span>
      </hlm-avatar>
    }
  </div>
} @else if(isCurrentUserMessage(message) && isLastMessage()) {
  <div hlmCardDescription class="text-xs text-end mt-1 opacity-70">
    <span
      >{{ `${(message.status | titlecase)} ${message.status !== 'sending' && message.status !== 'failed' ? (message.createdAt | timeAgo) : ''}` }}</span
    >
  </div>
}
