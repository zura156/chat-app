<main class="p-3 w-full min-h-screen">
  <header class="pt-2 flex flex-col gap-y-3">
    <section
      (clickOutside)="closeUserList()"
      class="flex justify-between gap-x-2 items-center"
    >
      <div>
        <h1 class="text-lg font-medium">To:</h1>
      </div>

      <div class="relative w-full flex items-center justify-between">
        <section class="w-full relative">
          <input
            hlmInput
            variant="search"
            id="userSearch"
            type="search"
            class="w-full pt-5 pb-10"
            placeholder="Search..."
            alt="search for people"
            [formControl]="searchControl"
            (focus)="toggleUserList()"
          />
          <div
            class="absolute flex gap-x-2 bottom-1 left-0 ml-4 text-sm cursor-pointer"
          >
            @for(user of selectedUsers(); track user) {
            <div
              class="border relative rounded-full pl-2 pr-5 bg-white dark:bg-black hover:bg-accent"
            >
              <span class="text-gray-500">
                {{ user.username }}
              </span>
              <ng-icon
                hlm
                size="sm"
                name="lucideX"
                class="absolute right-1 top-1/2 -translate-y-1/2 cursor-pointer"
                (click)="removeFromConversation(user)"
              >
              </ng-icon>
            </div>
            }
          </div>
        </section>

        <section
          *ngIf="showUserList() && users().length > 0"
          class="absolute w-full z-20 mt-2 left-0 top-full flex items-center gap-x-2"
        >
          <ng-scrollbar
            hlm
            class="bg-white dark:bg-black border-border h-72 w-full rounded-md border ovreflow-y-scroll"
          >
            <div class="p-3">
              <h4 class="text-sm font-medium leading-none">Users</h4>
              <div hlmSeparator class="my-2"></div>
              <div
                class="text-sm mb-2"
                *ngFor="let user of users(); let i = index"
                (click)="addToConversation(user)"
              >
                <app-user-card [user]="user"> </app-user-card>
              </div>
            </div>
          </ng-scrollbar>
        </section>
      </div>
    </section>
    <button
      hlmBtn
      (click)="createConversation()"
      [disabled]="selectedUsers().length < 1"
    >
      Create new
    </button>
  </header>

  <brn-separator decorative hlmSeparator />
</main>
